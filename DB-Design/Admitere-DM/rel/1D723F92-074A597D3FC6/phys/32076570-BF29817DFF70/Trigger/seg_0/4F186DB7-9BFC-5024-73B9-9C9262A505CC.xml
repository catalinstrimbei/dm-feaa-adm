<?xml version = '1.0' encoding = 'UTF-8'?>
<TriggerOraclev10g class="oracle.dbtools.crest.model.design.storage.oracle.v10g.TriggerOraclev10g" name="TRG_FISA_INS_AFTER_ROW" id="4F186DB7-9BFC-5024-73B9-9C9262A505CC" directorySegmentName="seg_0">
   <createdBy>catalin.strimbei</createdBy>
   <createdTime>2011-04-20 12:49:06 UTC</createdTime>
   <changedBy>catalin.strimbei</changedBy>
   <changedTime>2011-04-20 12:49:06 UTC</changedTime>
   <ownerDesignName>Admitere-DM</ownerDesignName>
   <actions>INSERT</actions>
   <body>DECLARE&amp;lt;br/&amp;gt;    v_are_voie BOOLEAN := FALSE ;&amp;lt;br/&amp;gt;BEGIN  &amp;lt;br/&amp;gt;    FOR i IN 1..pac_variabile_globale.vg_roluri.COUNT LOOP&amp;lt;br/&amp;gt;        IF pac_variabile_globale.vg_roluri (i) IN (&amp;apos;INSCRIERE&amp;apos;, &amp;apos;DBA&amp;apos;, &amp;apos;PRODECAN&amp;apos;) THEN&amp;lt;br/&amp;gt;            v_are_voie := TRUE ;&amp;lt;br/&amp;gt;        END IF ;            &amp;lt;br/&amp;gt;    END LOOP ;&amp;lt;br/&amp;gt;    IF v_are_voie = FALSE THEN&amp;lt;br/&amp;gt;        RAISE_APPLICATION_ERROR (-20152,&amp;apos;Nu aveti drepturi sa INSERATI in FISAINSCRIERE&amp;apos;) ;  &amp;lt;br/&amp;gt;    END IF ;&amp;lt;br/&amp;gt; &amp;lt;br/&amp;gt;    pac_variabile_globale.p_init_vg_atribute (&amp;apos;FISAINSCRIERE&amp;apos;) ;&amp;lt;br/&amp;gt;    SELECT seq_idmodif.NextVal INTO pac_variabile_globale.v_seq_idmodif FROM dual ;&amp;lt;br/&amp;gt;      &amp;lt;br/&amp;gt;    INSERT INTO admitere.modificari (idmodif, dataoram, operator, statiem, obs, cnp, idfisa, tip_modif, tabela)&amp;lt;br/&amp;gt;        VALUES (pac_variabile_globale.v_seq_idmodif, SYSDATE, &amp;lt;br/&amp;gt;            admitere.pac_variabile_globale.vg_operator, &amp;lt;br/&amp;gt;            admitere.pac_variabile_globale.vg_statie,&amp;lt;br/&amp;gt;            &amp;apos;INS-FISAINSCRIERE&amp;apos;, :NEW.cnp, :NEW.idfisa, &amp;apos;I&amp;apos;, &amp;apos;FISAINSCRIERE&amp;apos;) ;    &amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;    INSERT INTO ins_fisainscriere (&amp;lt;br/&amp;gt;CNP, NRFISA, CHIT, SUMA, SCUTIT, IDFISA, SITUATIECRT, TIPFISA, CONTRACT, RETRAS, OPINSCRIERE, &amp;lt;br/&amp;gt;OPCORECTIE, STINSCRIERE, STCORECTIE, DATAINSCRIERE, DATACORECTIE, PROFILADM, 	FSTUDIIADM, &amp;lt;br/&amp;gt;TAXAADM, CHITCONTRACT, SUMACONTRACT, LOCADM, OBSERVATII, VERDICT, FORTAT, LOC, &amp;lt;br/&amp;gt;SCUTIRE_MOTIVATIE, LBSTRAINA, LOCSPECIAL, SCUTITORFAN, SCUTITPLASAMENT, NRADEVERINTE, &amp;lt;br/&amp;gt;MEDGENADM, DIPLBAC, DIPLORIG, DIPLSERIE, DIPLNR, DIPLDATA, ADEV_LIC,  ADEV_ORIGINAL, ADEV_DATA,&amp;lt;br/&amp;gt;DIPLLICENTA, DIPLLICENTAORIG, DIPLLICENTASERIE, DIPLLICENTANR, DIPLLICENTADATA, &amp;lt;br/&amp;gt;FOAIEMATRICOLA, FOAIEMATRORIG, FOAIEMATRNR, FOAIEMATRDATA, DIPLBACCOPIELEGALIZATA, &amp;lt;br/&amp;gt;ADEV_COPIELEGALIZATA, DIPLANEMITERE, DIPLEMISDE,  ADEV_COPIENELEGALIZATA, &amp;lt;br/&amp;gt;DIPLBACCOPIENELEGALIZATA, MSDIPLBACSTATUS, idmodif&amp;lt;br/&amp;gt;            )             &amp;lt;br/&amp;gt;        VALUES (&amp;lt;br/&amp;gt;:new.CNP, :new.NRFISA, :new.CHIT, :new.SUMA, :new.SCUTIT, :new.IDFISA, :new.SITUATIECRT, :new.TIPFISA, :new.CONTRACT, :new.RETRAS, :new.OPINSCRIERE, &amp;lt;br/&amp;gt;:new.OPCORECTIE, :new.STINSCRIERE, :new.STCORECTIE, :new.DATAINSCRIERE, :new.DATACORECTIE, :new.PROFILADM, :new.FSTUDIIADM, &amp;lt;br/&amp;gt;:new.TAXAADM, :new.CHITCONTRACT, :new.SUMACONTRACT, :new.LOCADM, :new.OBSERVATII, :new.VERDICT, :new.FORTAT, :new.LOC, &amp;lt;br/&amp;gt;:new.SCUTIRE_MOTIVATIE, :new.LBSTRAINA, :new.LOCSPECIAL, :new.SCUTITORFAN, :new.SCUTITPLASAMENT, :new.NRADEVERINTE, &amp;lt;br/&amp;gt;:new.MEDGENADM, :new.DIPLBAC, :new.DIPLORIG, :new.DIPLSERIE, :new.DIPLNR, :new.DIPLDATA, :new.ADEV_LIC, :new.ADEV_ORIGINAL, :new.ADEV_DATA,&amp;lt;br/&amp;gt;:new.DIPLLICENTA, :new.DIPLLICENTAORIG, :new.DIPLLICENTASERIE, :new.DIPLLICENTANR, :new.DIPLLICENTADATA, &amp;lt;br/&amp;gt;:new.FOAIEMATRICOLA, :new.FOAIEMATRORIG, :new.FOAIEMATRNR, :new.FOAIEMATRDATA, :new.DIPLBACCOPIELEGALIZATA, &amp;lt;br/&amp;gt;:new.ADEV_COPIELEGALIZATA, :new.DIPLANEMITERE, :new.DIPLEMISDE, :new.ADEV_COPIENELEGALIZATA, &amp;lt;br/&amp;gt;:new.DIPLBACCOPIENELEGALIZATA, :new.MSDIPLBACSTATUS, pac_variabile_globale.v_seq_idmodif&amp;lt;br/&amp;gt;            )             ;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;     IF :NEW.idfisa &amp;lt;&amp;gt; :OLD.idfisa THEN&amp;lt;br/&amp;gt;        UPDATE optiunifise SET idfisa = :NEW.idfisa WHERE idfisa = :OLD.idfisa ;&amp;lt;br/&amp;gt;        UPDATE modificari SET idfisa = :NEW.idfisa WHERE idfisa = :OLD.idfisa ;&amp;lt;br/&amp;gt;        UPDATE stari_candidat SET idfisa = :NEW.idfisa WHERE idfisa = :OLD.idfisa ;&amp;lt;br/&amp;gt;        UPDATE motoras SET idfisa = :NEW.idfisa WHERE idfisa = :OLD.idfisa ;&amp;lt;br/&amp;gt;    END IF ;             &amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;    IF :NEW.tipfisa &amp;lt;&amp;gt; :OLD.tipfisa OR :NEW.nrfisa &amp;lt;&amp;gt; :OLD.nrfisa THEN&amp;lt;br/&amp;gt;        UPDATE motoras SET tipfisa = :NEW.tipfisa, nrfisa = :NEW.nrfisa&amp;lt;br/&amp;gt;             WHERE idfisa = :NEW.idfisa ;&amp;lt;br/&amp;gt;    END IF ;           &amp;lt;br/&amp;gt;    &amp;lt;br/&amp;gt;END ;</body>
   <triggerTime>AFTER</triggerTime>
   <owner>A19B0135-B306-9C2F-77BB-38712D8BCDB5</owner>
   <table>0A66D509-BA34-D29E-4656-9909455710E1</table>
</TriggerOraclev10g>