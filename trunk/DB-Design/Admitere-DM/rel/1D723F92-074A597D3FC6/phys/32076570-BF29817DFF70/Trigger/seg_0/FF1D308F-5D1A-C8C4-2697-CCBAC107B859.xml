<?xml version = '1.0' encoding = 'UTF-8'?>
<TriggerOraclev10g class="oracle.dbtools.crest.model.design.storage.oracle.v10g.TriggerOraclev10g" name="TRG_OPTIUNIFISE_DEL_AFTER_ROW" id="FF1D308F-5D1A-C8C4-2697-CCBAC107B859" directorySegmentName="seg_0">
   <createdBy>catalin.strimbei</createdBy>
   <createdTime>2011-04-20 12:49:06 UTC</createdTime>
   <changedBy>catalin.strimbei</changedBy>
   <changedTime>2011-04-20 12:49:06 UTC</changedTime>
   <ownerDesignName>Admitere-DM</ownerDesignName>
   <actions>DELETE</actions>
   <body>DECLARE&amp;lt;br/&amp;gt;    v_are_voie BOOLEAN := FALSE ;&amp;lt;br/&amp;gt;BEGIN  &amp;lt;br/&amp;gt;    FOR i IN 1..pac_variabile_globale.vg_roluri.COUNT LOOP&amp;lt;br/&amp;gt;        IF pac_variabile_globale.vg_roluri (i) IN (&amp;apos;CORECTIE&amp;apos;,&amp;apos;DBA&amp;apos;, &amp;apos;CONTRACTE&amp;apos;, &amp;apos;RETRAGERE&amp;apos;) THEN&amp;lt;br/&amp;gt;            v_are_voie := TRUE ;&amp;lt;br/&amp;gt;        END IF ;            &amp;lt;br/&amp;gt;    END LOOP ;&amp;lt;br/&amp;gt;    IF v_are_voie = FALSE THEN&amp;lt;br/&amp;gt;        RAISE_APPLICATION_ERROR (-20157,&amp;apos;Nu aveti drepturi sa stergeti in OPTIUNIFISE&amp;apos;) ; &amp;lt;br/&amp;gt;    END IF ;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;   IF :OLD.idfisa &amp;lt;&amp;gt; NVL(pac_variabile_globale.vg_idfisa_crt,0) THEN &amp;lt;br/&amp;gt;    pac_variabile_globale.vg_idfisa_crt := :OLD.idfisa ;&amp;lt;br/&amp;gt;    SELECT seq_idmodif.NextVal INTO pac_variabile_globale.v_seq_idmodif FROM dual ;&amp;lt;br/&amp;gt;      INSERT INTO admitere.modificari (idmodif, dataoram, operator, statiem, obs, cnp, &amp;lt;br/&amp;gt;      idfisa, tip_modif, tabela)&amp;lt;br/&amp;gt;        VALUES (pac_variabile_globale.v_seq_idmodif, SYSDATE, &amp;lt;br/&amp;gt;        admitere.pac_variabile_globale.vg_operator, &amp;lt;br/&amp;gt;         admitere.pac_variabile_globale.vg_statie,  &amp;apos;DEL-OPTIUNIFISE&amp;apos;, NULL,&amp;lt;br/&amp;gt;         :OLD.idfisa, &amp;apos;D&amp;apos;, &amp;apos;OPTIUNIFISE&amp;apos;) ;     &amp;lt;br/&amp;gt;  END IF ;&amp;lt;br/&amp;gt;  &amp;lt;br/&amp;gt;  CASE&amp;lt;br/&amp;gt;  --    chestionarul nu se jurnalizeaza&amp;lt;br/&amp;gt;  WHEN :OLD.CODOPT BETWEEN 44 AND 90 OR :OLD.CODOPT BETWEEN 744 AND 774 THEN&amp;lt;br/&amp;gt;      NULL ;&amp;lt;br/&amp;gt;      &amp;lt;br/&amp;gt;  -- specializari dorite la admiterea la licenta&amp;lt;br/&amp;gt;  WHEN :OLD.CODOPT BETWEEN 14 AND 23 OR :OLD.CODOPT BETWEEN 714 AND 723 THEN&amp;lt;br/&amp;gt;      INSERT INTO DEL_specializari VALUES (:OLD.idfisa, :OLD.codopt, :OLD.prioritate, pac_variabile_globale.v_seq_idmodif) ;&amp;lt;br/&amp;gt;  &amp;lt;br/&amp;gt;  -- limbile straine&amp;lt;br/&amp;gt;  WHEN :OLD.CODOPT BETWEEN 24 AND 43 OR :OLD.CODOPT BETWEEN 92 AND 93 OR :OLD.CODOPT BETWEEN 724 AND 733 THEN&amp;lt;br/&amp;gt;      INSERT INTO DEL_LBSTRAINE VALUES (:OLD.idfisa, :OLD.codopt, :OLD.prioritate, pac_variabile_globale.v_seq_idmodif) ;&amp;lt;br/&amp;gt;  &amp;lt;br/&amp;gt;  -- mastere de specializare&amp;lt;br/&amp;gt;  WHEN :OLD.CODOPT BETWEEN 501 AND 520 OR :OLD.CODOPT BETWEEN 601 AND 620 THEN&amp;lt;br/&amp;gt;      INSERT INTO DEL_ms VALUES (:OLD.idfisa, :OLD.codopt, :OLD.prioritate, pac_variabile_globale.v_seq_idmodif) ;      &amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;  -- mastere complementare&amp;lt;br/&amp;gt;  WHEN :OLD.CODOPT BETWEEN 801 AND 826 OR :OLD.CODOPT BETWEEN 901 AND 917 THEN&amp;lt;br/&amp;gt;      INSERT INTO DEL_mc VALUES (:OLD.idfisa, :OLD.codopt, :OLD.prioritate, pac_variabile_globale.v_seq_idmodif) ;      &amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;  ELSE&amp;lt;br/&amp;gt;    INSERT INTO DEL_elal VALUES (:OLD.idfisa, :OLD.codopt, :OLD.prioritate, pac_variabile_globale.v_seq_idmodif) ;&amp;lt;br/&amp;gt;  &amp;lt;br/&amp;gt;  &amp;lt;br/&amp;gt;  END CASE ;   END ;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt; &amp;lt;br/&amp;gt;    &amp;lt;br/&amp;gt;</body>
   <triggerTime>AFTER</triggerTime>
   <owner>A19B0135-B306-9C2F-77BB-38712D8BCDB5</owner>
   <table>8470276C-0BA4-8926-C1CF-8138C7723238</table>
</TriggerOraclev10g>