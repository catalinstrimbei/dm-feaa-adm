<?xml version = '1.0' encoding = 'UTF-8'?>
<TriggerOraclev10g class="oracle.dbtools.crest.model.design.storage.oracle.v10g.TriggerOraclev10g" name="TRG_DATEGEN_UPD_AFTER_ROW" id="CD8012A1-061F-461E-6D84-913FDBF0171D" directorySegmentName="seg_0">
   <createdBy>catalin.strimbei</createdBy>
   <createdTime>2011-04-20 12:49:06 UTC</createdTime>
   <changedBy>catalin.strimbei</changedBy>
   <changedTime>2011-04-20 12:49:06 UTC</changedTime>
   <ownerDesignName>Admitere-DM</ownerDesignName>
   <actions>UPDATE</actions>
   <body>DECLARE&amp;lt;br/&amp;gt;    v_are_voie BOOLEAN := FALSE ;&amp;lt;br/&amp;gt;BEGIN  &amp;lt;br/&amp;gt;    FOR i IN 1..pac_variabile_globale.vg_roluri.COUNT LOOP&amp;lt;br/&amp;gt;        IF pac_variabile_globale.vg_roluri (i) IN (&amp;apos;CORECTIE&amp;apos;,&amp;apos;DBA&amp;apos;, &amp;apos;CONTRACTE&amp;apos;, &amp;apos;RETRAGERE&amp;apos;) THEN&amp;lt;br/&amp;gt;            v_are_voie := TRUE ;&amp;lt;br/&amp;gt;        END IF ;            &amp;lt;br/&amp;gt;    END LOOP ;&amp;lt;br/&amp;gt;    IF v_are_voie = FALSE THEN&amp;lt;br/&amp;gt;        RAISE_APPLICATION_ERROR (-20151,&amp;apos;Nu aveti drepturi sa modificati DATEGEN&amp;apos;) ; &amp;lt;br/&amp;gt;    END IF ;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;  IF :NEW.medgenlic &amp;lt;&amp;gt; :OLD.medgenlic OR :NEW.medgenbac &amp;lt;&amp;gt; :OLD.medgenbac THEN&amp;lt;br/&amp;gt;      pac_variabile_globale.vg_vin_din_dategen := TRUE ;&amp;lt;br/&amp;gt;      UPDATE fisainscriere &amp;lt;br/&amp;gt;        SET medgenadm = TRUNC(:NEW.medgenlic * 0.75 + :NEW.medgenbac * 0.25, 2) &amp;lt;br/&amp;gt;        WHERE cnp = :NEW.cnp AND (tipfisa LIKE &amp;apos;EL%&amp;apos; OR tipfisa LIKE &amp;apos;AL%&amp;apos;) ;   &amp;lt;br/&amp;gt;      pac_variabile_globale.vg_vin_din_dategen := FALSE ;        &amp;lt;br/&amp;gt;  END IF ;  &amp;lt;br/&amp;gt;  IF :NEW.medanistud &amp;lt;&amp;gt; :OLD.medanistud OR :NEW.medlicenta &amp;lt;&amp;gt; :OLD.medlicenta  THEN&amp;lt;br/&amp;gt;      pac_variabile_globale.vg_vin_din_dategen := TRUE ;&amp;lt;br/&amp;gt;      UPDATE fisainscriere &amp;lt;br/&amp;gt;        SET medgenadm = TRUNC(:NEW.medanistud * 0.6 + :NEW.medlicenta * 0.4, 2) &amp;lt;br/&amp;gt;        WHERE cnp=:NEW.cnp AND tipfisa LIKE &amp;apos;M%&amp;apos; ;   &amp;lt;br/&amp;gt;      pac_variabile_globale.vg_vin_din_dategen := FALSE ;        &amp;lt;br/&amp;gt;  END IF ;  &amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;    pac_variabile_globale.p_init_vg_atribute (&amp;apos;DATEGEN&amp;apos;) ;&amp;lt;br/&amp;gt;    SELECT seq_idmodif.NextVal INTO pac_variabile_globale.v_seq_idmodif FROM dual ;&amp;lt;br/&amp;gt;    &amp;lt;br/&amp;gt;    INSERT INTO admitere.modificari (idmodif, dataoram, operator, statiem, obs, cnp, tip_modif, tabela)&amp;lt;br/&amp;gt;        VALUES (pac_variabile_globale.v_seq_idmodif, SYSDATE, &amp;lt;br/&amp;gt;          admitere.pac_variabile_globale.vg_operator, &amp;lt;br/&amp;gt;            admitere.pac_variabile_globale.vg_statie,&amp;lt;br/&amp;gt;            &amp;apos;UPD-DATEGEN&amp;apos;, :NEW.cnp, &amp;apos;U&amp;apos;, &amp;apos;DATEGEN&amp;apos;) ;    &amp;lt;br/&amp;gt; &amp;lt;br/&amp;gt;     INSERT INTO admitere.upd_dategen (&amp;lt;br/&amp;gt;CNP, NUME, SEX, STARECIV, NUMEINCAS, CAZARE, MEDICCMP, ROM, BASARABEAN, PASSWORD, &amp;lt;br/&amp;gt;DATANAST, LOCNAST, JUDNAST, TARANAST, BISERIE, BINR, BIELIBLA, BIELIBDE, TATA, MAMA, SAT, &amp;lt;br/&amp;gt;STRADA, NR, BLOC, ETAJ, APART, TEL, MOBIL, EMAIL, TARA, CODLICEU, ANABSOLV, MEDGENBAC, &amp;lt;br/&amp;gt;MEDLICAN5, MEDGENLIC, IDLOCNAST, IDLOCBI, CNPGRESIT, PRENUME, INITIALA_TATALUI, &amp;lt;br/&amp;gt;STAGIU_MILITAR, STUD_FACULT, STUD_AN, STUD_TAXA, STUD_NRSEM, STUD_STATPART,&amp;lt;br/&amp;gt;BUGET_STAT, BUGET_NRSEM, BURSA_STUD, BURSA_NRSEM, CODPOSTAL, CODFACULT, &amp;lt;br/&amp;gt;SPECIALIZARE_FACULT, ANABSOLV_FACULT, CETATENIE, NATIONALITATE, SCARA, MEDANISTUD, &amp;lt;br/&amp;gt;MEDLICENTA, CERTIFCOMPETENTALINGVISTICA, TIPCERTIFCOMPETENTALINGVISTICA, &amp;lt;br/&amp;gt;TESTENGLEZA, PUNCTAJCERTIFCOMPETENTALINGV, OPTIUNEPTSTEC, ETNIE, &amp;lt;br/&amp;gt;STARESOCSPEC, PROFILLICEU, DURATALICEU, FORMAINVLICEU, NRACTSTUDIISTRAINATATE, &amp;lt;br/&amp;gt;SERIEACTSTUDIISTRAINATATE, ADMITERIMULTIPLE, DIZABILITATI, PROFILFACULTATE, &amp;lt;br/&amp;gt;TITLUFACULTATE, FORMAINVFACULT, FORMAFINANTAREFACULT, DURATAFACULTATE, &amp;lt;br/&amp;gt;TIPDIPLOMAFACULT, DIPLSERIEFACULT, DIPLNRFACULT, DIPLEMISDEFACULT, DIPLANEMITEREFACULT, &amp;lt;br/&amp;gt;FOAIEMATRFACULT, DIPLRECUNOASTERENRFACULT, DIPLRECUNOASTERESERIEFACULT, &amp;lt;br/&amp;gt;OLIMPIC, BIVALABILPANALA, ANABSOLVFACULTATE, MSDIPLOMAFACULTLAFEAA, idmodif&amp;lt;br/&amp;gt;     )   &amp;lt;br/&amp;gt;    VALUES (  &amp;lt;br/&amp;gt;      :new.CNP, :new.NUME, :new.SEX, :new.STARECIV, :new.NUMEINCAS, :new.CAZARE, :new.MEDICCMP, :new.ROM, :new.BASARABEAN, :new.PASSWORD, &amp;lt;br/&amp;gt;:new.DATANAST, :new.LOCNAST, :new.JUDNAST, :new.TARANAST, :new.BISERIE, :new.BINR, :new.BIELIBLA, :new.BIELIBDE, :new.TATA, :new.MAMA, :new.SAT,&amp;lt;br/&amp;gt; :new.STRADA, :new.NR, :new.BLOC, :new.ETAJ, :new.APART, :new.TEL, :new.MOBIL, :new.EMAIL, :new.TARA, :new.CODLICEU, :new.ANABSOLV, :new.MEDGENBAC,&amp;lt;br/&amp;gt; :new.MEDLICAN5, :new.MEDGENLIC, :new.IDLOCNAST, :new.IDLOCBI, :new.CNPGRESIT, :new.PRENUME, :new.INITIALA_TATALUI, &amp;lt;br/&amp;gt; :new.STAGIU_MILITAR, :new.STUD_FACULT, :new.STUD_AN, :new.STUD_TAXA, :new.STUD_NRSEM, :new.STUD_STATPART, &amp;lt;br/&amp;gt; :new.BUGET_STAT, :new.BUGET_NRSEM, :new.BURSA_STUD, :new.BURSA_NRSEM, :new.CODPOSTAL, :new.CODFACULT, &amp;lt;br/&amp;gt;:new.SPECIALIZARE_FACULT, :new.ANABSOLV_FACULT, :new.CETATENIE, :new.NATIONALITATE, :new.SCARA, :new.MEDANISTUD, &amp;lt;br/&amp;gt;:new.MEDLICENTA, :new.CERTIFCOMPETENTALINGVISTICA, :new.TIPCERTIFCOMPETENTALINGVISTICA, &amp;lt;br/&amp;gt;:new.TESTENGLEZA, :new.PUNCTAJCERTIFCOMPETENTALINGV, :new.OPTIUNEPTSTEC, :new.ETNIE, &amp;lt;br/&amp;gt;:new.STARESOCSPEC, :new.PROFILLICEU, :new.DURATALICEU, :new.FORMAINVLICEU, :new.NRACTSTUDIISTRAINATATE, &amp;lt;br/&amp;gt;:new.SERIEACTSTUDIISTRAINATATE, :new.ADMITERIMULTIPLE, :new.DIZABILITATI, :new.PROFILFACULTATE, &amp;lt;br/&amp;gt;:new.TITLUFACULTATE, :new.FORMAINVFACULT, :new.FORMAFINANTAREFACULT, :new.DURATAFACULTATE, &amp;lt;br/&amp;gt; :new.TIPDIPLOMAFACULT, :new.DIPLSERIEFACULT, :new.DIPLNRFACULT, :new.DIPLEMISDEFACULT, :new.DIPLANEMITEREFACULT,&amp;lt;br/&amp;gt; :new.FOAIEMATRFACULT, :new.DIPLRECUNOASTERENRFACULT, :new.DIPLRECUNOASTERESERIEFACULT, &amp;lt;br/&amp;gt; :new.OLIMPIC, :new.BIVALABILPANALA, :new.ANABSOLVFACULTATE, :new.MSDIPLOMAFACULTLAFEAA, pac_variabile_globale.v_seq_idmodif&amp;lt;br/&amp;gt;         ) ;&amp;lt;br/&amp;gt;      &amp;lt;br/&amp;gt;    IF :NEW.cnp &amp;lt;&amp;gt; :OLD.cnp THEN&amp;lt;br/&amp;gt;        UPDATE fisainscriere SET cnp = :NEW.cnp WHERE cnp = :OLD.cnp ;&amp;lt;br/&amp;gt;        UPDATE ins_fisainscriere SET cnp = :NEW.cnp WHERE cnp = :OLD.cnp ;&amp;lt;br/&amp;gt;        UPDATE upd_fisainscriere SET cnp = :NEW.cnp WHERE cnp = :OLD.cnp ;&amp;lt;br/&amp;gt;        UPDATE del_fisainscriere SET cnp = :NEW.cnp WHERE cnp = :OLD.cnp ;&amp;lt;br/&amp;gt;        UPDATE modificari SET cnp = :NEW.cnp WHERE cnp = :OLD.cnp ;             &amp;lt;br/&amp;gt;        UPDATE taxestudachit SET cnp = :NEW.cnp WHERE cnp = :OLD.cnp ;&amp;lt;br/&amp;gt;    END IF ;&amp;lt;br/&amp;gt;            &amp;lt;br/&amp;gt;END ;</body>
   <triggerTime>AFTER</triggerTime>
   <owner>A19B0135-B306-9C2F-77BB-38712D8BCDB5</owner>
   <table>091E20D3-C348-43A6-98D6-F6D8F08B4AA4</table>
</TriggerOraclev10g>